\ProvidesPackage{hegel}

%%% PACKAGES
%%%------------------------------------------------------------------------

\usepackage[T2A]{fontenc}
\usepackage[greek,english,main=russian]{babel}
\usepackage[final,letterspace=150]{microtype} % Less badboxes
\usepackage{bookmark}
\usepackage{footnotehyper}
\usepackage{multicol}
\usepackage{geometry}
\usepackage{pifont}

% \usepackage{kpfonts} %Font

\usepackage{amsmath,amssymb,mathtools} % Math

% \usepackage{tikz} % Figures
\usepackage{graphicx} % Include figures

% Отметка о версии черновика на каждой странице
% Чтобы работало надо в своей локальной копии по инструкции
% https://www.ctan.org/pkg/gitinfo2 создать небходимые файлы в папке
% ./git/hooks
% If you’re familiar with tweaking git, you can probably work it out for
% yourself. If not, I suggest you follow these steps:
% 1. First, you need a git repository and working tree. For this example,
% let’s suppose that the root of the working tree is in ~/compsci
% 2. Copy the file post-xxx-sample.txt (which is in the same folder of
% your TEX distribution as this pdf) into the git hooks directory in your
% working copy. In our example case, you should end up with a file called
% ~/compsci/.git/hooks/post-checkout
% 3. If you’re using a unix-like system, don’t forget to make the file executable.
% Just how you do this is outside the scope of this manual, but one
% possible way is with commands such as this:
% chmod g+x post-checkout.
% 4. Test your setup with “git checkout master” (or another suitable branch
% name). This should generate copies of gitHeadInfo.gin in the directories
% you intended.
% 5. Now make two more copies of this file in the same directory (hooks),
% calling them post-commit and post-merge, and you’re done. As before,
% users of unix-like systems should ensure these files are marked as
% executable.
%\ifnumequal{\value{draft}}{1}{% Черновик
   \IfFileExists{.git/gitHeadInfo.gin}{
      \usepackage[mark,pcount]{gitinfo2}
      \renewcommand{\gitMark}{rev.\gitAbbrevHash\ \gitDirty\quad{}branch: \gitBranch\quad{}tags: \gitTags\\\gitCommitterIsoDate}
   }{}
%}{}

%%% PAGE LAYOUT
%%%------------------------------------------------------------------------

\setlrmarginsandblock{0.11\paperwidth}{*}{1} % Left and right margin
\setulmarginsandblock{0.14\paperwidth}{*}{1} % Upper and lower margin
\checkandfixthelayout

\clubpenalty=10000
\widowpenalty=10000
\raggedbottom

%%% SECTIONAL DIVISIONS
%%%------------------------------------------------------------------------

\maxsecnumdepth{subparagraph}
\setsecnumdepth{subsubsection}

\makechapterstyle{standard}{
  \setlength{\beforechapskip}{0.8\baselineskip}
  \setlength{\midchapskip}{0\baselineskip}
  \setlength{\afterchapskip}{0.5\baselineskip}
  \renewcommand{\chapterheadstart}{\vspace*{\beforechapskip}}
  \renewcommand{\chapnamefont}{\centering\normalfont\Large}
  \renewcommand{\printchaptername}{\chapnamefont \@chapapp}
  \renewcommand{\chapternamenum}{\space}
  \renewcommand{\chapnumfont}{\normalfont\Large}
  \renewcommand{\printchapternum}{\chapnumfont \thechapter}
  \renewcommand{\afterchapternum}{\par\nobreak\vskip \midchapskip}
  \renewcommand{\printchapternonum}{\vspace*{\midchapskip}\vspace*{5mm}}
  \renewcommand{\chaptitlefont}{\centering\bfseries\normalsize}
  \renewcommand{\printchaptertitle}[1]{\chaptitlefont ##1}
  \renewcommand{\afterchaptertitle}{\par\nobreak\vskip \afterchapskip}

  % Part titles
  \renewcommand{\beforepartskip}{}
  \renewcommand{\afterpartskip}{\bigskip}

  \renewcommand{\clearforchapter}{}
}

% FIXME: временный стиль для 2 и 3 книги
\makechapterstyle{standardtwo}{
  \setlength{\beforechapskip}{0\baselineskip}
  \setlength{\midchapskip}{1\baselineskip}
  \setlength{\afterchapskip}{2\baselineskip}
  \renewcommand{\chapterheadstart}{\vspace*{\beforechapskip}}
  \renewcommand{\chapnamefont}{\centering\normalfont\Large}
  \renewcommand{\printchaptername}{\chapnamefont \@chapapp}
  \renewcommand{\chapternamenum}{\space}
  \renewcommand{\chapnumfont}{\normalfont\Large}
  \renewcommand{\printchapternum}{\chapnumfont \thechapter}
  \renewcommand{\afterchapternum}{\par\nobreak\vskip \midchapskip}
  \renewcommand{\printchapternonum}{\vspace*{\midchapskip}\vspace*{5mm}}
  \renewcommand{\chaptitlefont}{\centering\bfseries\normalsize}
  \renewcommand{\printchaptertitle}[1]{\chaptitlefont ##1}
  \renewcommand{\afterchaptertitle}{\par\nobreak\vskip \afterchapskip}

  % Part titles
  \renewcommand{\beforepartskip}{}
  \renewcommand{\afterpartskip}{\bigskip}

  \renewcommand{\clearforchapter}{}
}

\chapterstyle{standard}

\newcommand{\addtocspace}[1]{%
  \addtocontents{toc}{\vspace{#1}}}

\newcommand{\hegpart}[2][]{%
  \addtocontents{toc}{\vspace{4mm}%
    {\centering\bfseries\em #1\\\vspace{2mm}}}%
  \part[\texorpdfstring{\MakeTextUppercase{\small#2}}{#1. #2}]%
       {\begin{Spacing}{1.6}\small\textsc{\lsstyle\mdseries%
        #1}\nopagebreak\\\normalsize\MakeTextUppercase{#2}\end{Spacing}}}

\newcommand{\hegchapter}[2][]{%
  \chapter[{\em #1.} #2]{%
    \fontsize{11}{18}\selectfont{\em\mdseries #1}\nopagebreak%
    \vspace{1mm}\\%
    \MakeUppercase{#2}%
    \nopagebreak%
    \vspace{2mm}\\}%
    \addtocspace{1mm}%
    \thispagestyle{plain}}

\newcommand{\hegsection}[2][]{%
  \section[#1]{\small\MakeUppercase{#2}}}

\newcommand{\hegremark}[3][]{%
  \subsubsection[#1. #2]{\centering {\lsstyle\mdseries #1}\nopagebreak%
  \vspace{1mm}\\%
  \footnotesize #3}}

\setsecheadstyle{\normalfont\bfseries\centering}
\setsubsecheadstyle{\normalfont\normalsize\bfseries\centering}
\setparaheadstyle{\normalfont\normalsize\bfseries}
\setparaindent{0pt}\setafterparaskip{0pt}

%%---\subsubsubsection
\newcounter{subsubsubsection}[subsubsection] \setcounter{subsubsubsection}{1}
\newcommand{\subsubsubsectiongreek}{%
    \renewcommand{\thesubsubsubsection}{%
%        \foreignlanguage{greek}{\alph{subsubsubsection}})}%
    \greeknumeral{\value{subsubsubsection}})}%
    \renewcommand\subsubsubsectionsecnumformat{%
        \textls[0]{\upshape\thesubsubsubsection}\ }%
    \setsubsubsubseheadstyle{\footnotesize\itshape\centering\textls[100]}%
    \subsubsubsectionT}
\newcommand{\subsubsubsection}{%
    \renewcommand{\thesubsubsubsection}{\@arabic\c@subsubsubsection.}%
    \setsubsubsubseheadstyle{\normalsize\bfseries\centering}%
    \subsubsubsectionT}
\newcommand{\subsubsubsectionT}{% line3830
  \subsubsubsehook%
  \@startsection{subsubsubsection}{4}%  level 4
      {\subsubsubseindent}%            heading indent
      {\beforesubsubsubseskip}%        skip before the heading
      {\aftersubsubsubseskip}%         skip after the heading
      {\normalfont\subsubsubseheadstyle}} % font
\newcommand{\subsubsubsehook}{}
\newcommand{\setsubsubsubsehook}[1]{\renewcommand{\subsubsubsehook}{#1}}
\newlength{\subsubsubseindent}
\newcommand{\setsubsubsubseindent}[1]{%
            \setlength{\subsubsubseindent}{#1}}
\setsubsubsubseindent{\z@}
\newskip\beforesubsubsubseskip
\newcommand{\setbeforesubsubsubseskip}[1]{%
            \setlength{\beforesubsubsubseskip}{#1}}
\setbeforesubsubsubseskip{-3.25ex \@plus -1ex \@minus -.2ex}
\newskip\aftersubsubsubseskip
\newcommand{\setaftersubsubsubseskip}[1]{%
            \setlength{\aftersubsubsubseskip}{#1}}
\setaftersubsubsubseskip{1.5ex \@plus .2ex}
\newcommand{\subsubsubseheadstyle}{}
\newcommand{\setsubsubsubseheadstyle}[1]{%
            \renewcommand{\subsubsubseheadstyle}{#1}}
\setsubsubsubseheadstyle{\normalsize\bfseries\memRTLraggedright}
\newcommand\subsubsubsectionsecnumformat{%
    \csname thesubsubsubsection\endcsname\quad}
\newlistentry[subsubsection]{subsubsubsection}{toc}{3}
\cftsetindents{subsubsubsection}{10.0em}{0.8em}
\newcommand*{\subsubsubsectionmark}[1]{}
\renewcommand*{\cftsubsubsubsectionaftersnumb}{\enspace}


%%---\subsubremark
\newcounter{subsubremark}[subsubsection] \setcounter{subsubremark}{1}
\renewcommand*{\thesubsubremark}{\@arabic\c@subsubremark}
\newcommand{\subsubremark}[1]{%
  \ifnumgreater{\value{secnumdepth}}{3}{%
    \ifblank{#1}{% Есть нумерация нет заголовка
      \subsubremarkT{}
    }{% Есть нумерация есть заголовок
      \subsubremarkT[{#1}]{[{#1}]}
    }
  }{
    \ifblank{#1}{% Нет нумерации нет заголовка
      \subsubremarkT[Примечание]{{\remarksecnumformatPre{Примечание}}}
    }{% Нет нумерации есть заголовок
      \subsubremarkT[Примечание. #1]{{%
          \remarksecnumformatPre{Примечание\remarksecnumSkip}\\}{[#1]}}
    }
  }
}
\newcommand{\subsubremarkT}{% line3830
  \remhook%
  \@startsection{subsubremark}{4}%  level 4
      {\remindent}%            heading indent
      {\beforeremskip}%        skip before the heading
      {\afterremskip}%         skip after the heading
      {\normalfont\remheadstyle}} % font
\newcommand{\remhook}{}
\newcommand{\setremhook}[1]{\renewcommand{\remhook}{#1}}
\newlength{\remindent}
\newcommand{\setremindent}[1]{%
            \setlength{\remindent}{#1}}
\setremindent{\z@}
\newskip\beforeremskip
\newcommand{\setbeforeremskip}[1]{%
            \setlength{\beforeremskip}{#1}}
\setbeforeremskip{-3.25ex \@plus -1ex \@minus -.2ex}
\newskip\afterremskip
\newcommand{\setafterremskip}[1]{%
            \setlength{\afterremskip}{#1}}
\setafterremskip{1.5ex \@plus .2ex}
\newcommand{\remheadstyle}{}
\newcommand{\setremheadstyle}[1]{%
            \renewcommand{\remheadstyle}{#1}}
\newcommand*{\shortcenter}[1]{%
  \sethangfrom{\noindent  ##1}%
  \normalfont\boldmath\bfseries\footnotesize%
  \centering\hfil\parbox{0.8\textwidth}{\centering #1}%
}
\setremheadstyle{\shortcenter}
\newlistentry[subsubsection]{subsubremark}{toc}{3}
  \cftsetindents{subsubremark}{10.0em}{0.8em}
\newcommand{\subsubremarkmark}[1]{}
\newcommand\remarksecnumformatPre{%
        \normalsize\lsstyle\mdseries\centering}
\newcommand\remarksecnumname{Примечание\ }
\newcommand\remarksecnumSkip{\vspace{1mm}}
\newcommand\subsubremarksecnumformat{{%
    \remarksecnumformatPre\remarksecnumname%
    \thesubsubremark\remarksecnumSkip\par}}
\renewcommand{\cftsubsubremarkname}{\remarksecnumname}
\renewcommand*{\cftsubsubremarkaftersnum}{.}
\renewcommand*{\cftsubsubremarkaftersnumb}{\enspace}


%%---\subsubsubremark
\newcounter{subsubsubremark}[subsubsubsection] \setcounter{subsubsubremark}{1}
\renewcommand*{\thesubsubsubremark}{\@arabic\c@subsubsubremark}
\newcommand{\subsubsubremark}[1]{%
  \ifnumgreater{\value{secnumdepth}}{4}{%
    \ifblank{#1}{% Есть нумерация нет заголовка
      \subsubsubremarkT{}
    }{% Есть нумерация есть заголовок
      \subsubsubremarkT[{#1}]{[{#1}]}
    }
  }{
    \ifblank{#1}{% Нет нумерации нет заголовка
      \subsubsubremarkT[Примечание]{{\remarksecnumformatPre{Примечание}}}
    }{% Нет нумерации есть заголовок
      \subsubsubremarkT[Примечание. #1]{{%
          \remarksecnumformatPre{Примечание\remarksecnumSkip}\\}{[#1]}}
    }
  }
}
\newcommand{\subsubsubremarkT}{% line3830
  \remhook%
  \@startsection{subsubsubremark}{5}%  level 5
                {\remindent}%            heading indent
                {\beforeremskip}%        skip before the heading
                {\afterremskip}%         skip after the heading
                {\normalfont\remheadstyle}} % font
\newlistentry[subsubsubsection]{subsubsubremark}{toc}{4}
  \cftsetindents{subsubsubremark}{11.0em}{0.8em}
\newcommand{\subsubsubremarkmark}[1]{}
\newcommand\subsubsubremarksecnumformat{%
    {\remarksecnumformatPre\remarksecnumname\thesubsubsubremark%
    \remarksecnumSkip\par}}
\renewcommand*{\cftsubsubsubremarkname}{\remarksecnumname}
\renewcommand*{\cftsubsubsubremarkaftersnum}{.}
\renewcommand*{\cftsubsubsubremarkaftersnumb}{\enspace}

%-- Формат номера раздела по умолчанию
\setsecnumformat{%
  \@ifundefined{#1secnumformat}{% nope, use a default
    \csname the#1\endcsname\quad%
  }{%
    \csname #1secnumformat\endcsname%
  }%
}


\usepackage{indentfirst}
\setlength\parindent{6mm}

%%% FLOATS AND CAPTIONS
%%%------------------------------------------------------------------------

% You do not need to write [htpb] all the time
\renewcommand\fps@figure{htbp}
\renewcommand\fps@table{htbp}

\captiondelim{\space } % A space between caption name and text
\captionnamefont{\small\bfseries} % Font of the caption name
\captiontitlefont{\small\normalfont} % Font of the caption text

\changecaptionwidth % Change the width of the caption
\captionwidth{1\textwidth}

%%% ABSTRACT
%%%------------------------------------------------------------------------

\renewcommand{\abstractnamefont}{\normalfont\small\bfseries} % Abstract title
\setlength{\absleftindent}{0.1\textwidth} % Width of abstract
\setlength{\absrightindent}{\absleftindent}

\tightlists

%%% HEADER AND FOOTER
%%%------------------------------------------------------------------------

\makepagestyle{standard} % Make standard pagestyle

% Define standard pagestyle
\makeevenfoot{standard}{}{}{}
\makeoddfoot{standard}{}{}{}
\makeevenhead{standard}{\bfseries\thepage\normalfont\qquad\small\leftmark}{}{}
\makeoddhead{standard}{}{}{\small\rightmark\qquad\bfseries\thepage}
% \makeheadrule{standard}{\textwidth}{\normalrulethickness}

\makepsmarks{standard}{
\createmark{chapter}{both}{nonumber}{\@chapapp\ }{ \quad }
\createmark{chapter}{right}{nonumber}{}{ \quad }
\createmark{section}{right}{nonumber}{}{ \quad }
\createmark{subsection}{right}{nonumber}{}{ \quad }
\createplainmark{toc}{both}{\contentsname}
\createplainmark{lof}{both}{\listfigurename}
\createplainmark{lot}{both}{\listtablename}
\createplainmark{bib}{both}{\bibname}
\createplainmark{index}{both}{\indexname}
\createplainmark{glossary}{both}{\glossaryname}
}

\makepagestyle{chap} % Make new chapter pagestyle

\makeevenfoot{chap}{}{}{} % Define new chapter pagestyle
\makeoddfoot{chap}{}{}{}
\makeevenhead{chap}{}{}{}
\makeoddhead{chap}{}{}{}
% \makeheadrule{chap}{\textwidth}{\normalrulethickness}

\nouppercaseheads
\pagestyle{standard}   % Choosing pagestyle and chapter pagestyle
\aliaspagestyle{chapter}{chap}

%%% END NOTES
%%%------------------------------------------------------------------------
\makepagenote
\continuousnotenums
\notepageref

\let\oldpagenote\pagenote%
  \renewcommand{\pagenote}[1]{%
  {\fontsize{8}{8}\selectfont%
  \:\oldpagenote{#1}}}

\let\oldfootnote\footnote%
  \renewcommand{\footnote}[1]{%
  \,\oldfootnote{~#1}}

\renewcommand{\noteidinnotes}[2]{%
  \hspace{9mm}\textsuperscript{#1}\hspace{1.5mm}}
\renewcommand{\pageinnotes}[1]{%
  К~\hyperref[#1]{стр.~\pageref*{#1}.} ---}

\renewcommand*{\thefootnote}{\ding{93}}

\renewcommand*{\footnoterule}{%
  \kern-3pt%
  \hrule width 0.17\columnwidth
  \kern 2.6pt
  \vspace{1mm}}

\renewcommand*{\notedivision}{}

\renewcommand*{\pagenotesubhead}[3]{}

\renewcommand*{\pagenotesubheadstarred}[3]{}

%%% TEXT
%%%------------------------------------------------------------------------

\renewcommand{\baselinestretch}{0.82}
\setPagenoteSpacing{0.82}
\setFloatSpacing{0.82}

%%% NEW COMMANDS
%%%------------------------------------------------------------------------

\newcommand{\hm}[1]{#1\nobreak\discretionary{}{\hbox{\ensuremath{#1}}}{}}

\maxtocdepth{subparagraph} % ToC depth
\settocdepth{subparagraph}
\addto\captionsrussian{\renewcommand{\contentsname}{ОГЛАВЛЕНИЕ}}
\setlength{\cftbeforepartskip}{0.5mm}

\AtEndDocument{\addtocontents{toc}{\par}} % Add a \par to the end of the TOC

\usepackage{hyperref}   % Internal hyperlinks
\usepackage{memhfixc}



\renewcommand{\partnumberline}[1]{} % Remove part number in ToC
\renewcommand{\cftpartdotsep}{\cftdotsep} % Part dots in ToC
\renewcommand{\chapternumberline}[1]{} % Remove chapter number in ToC
\renewcommand{\cftchapterdotsep}{\cftdotsep} % Chapter dots in ToC

\renewcommand{\printpartname}{}
\renewcommand{\thepart}{}

\renewcommand{\printchaptername}{}
\renewcommand{\thechapter}{}

%\renewcommand{\@seccntformat}[1]{}

% Remove section numbers in ToC
\let\oldcftsf\cftsectionfont% save definition of \cftsectionfont
\let\oldcftspn\cftsectionafterpnum% and of \cftsectionafterpnum
\renewcommand*{\cftsectionfont}{%
\let\oldnl\numberline% save definition of \numberline
\renewcommand*{\numberline}[1]{}% change it
\oldcftsf} % use original \cftsectionfont
\renewcommand*{\cftsectionafterpnum}{%
\let\numberline\oldnl% % restore orginal \numberline
\oldcftspn} % use original \cftsectionafterpnum

\cftpagenumbersoff{book}
\renewcommand*{\cftbookfont}{\hfil}
\renewcommand*{\cftbookafterpnum}{\hfil}

% разделитель абзацев - короткая линия по центру
\newcommand{\sectionline}{%
  {\centering \raisebox{0pt}[1.5ex][1.5ex]{\rule{0.9cm}{0.4pt}} \par}
}

\endinput
